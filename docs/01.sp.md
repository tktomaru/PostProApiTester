# システム企画書：PostPro API Tester Chrome 拡張

## エグゼクティブサマリー

PostPro API Testerは、ブラウザネイティブなAPI開発・テストプラットフォームとして設計されたChrome拡張機能です。主要機能は実装完了済みで、Chrome Web Store公開準備段階にあります。

**主要特徴**: Postman互換テストAPI、包括的なテスト機能、チーム共有機能
**現在の状況**: v3.0.0実装完了、単体・統合テスト完備
**次期計画**: Chrome Web Store公開、ユーザビリティ向上、プラグインシステム実装

## 読書ガイド

| 読者タイプ | 推奨セクション |
|------------|----------------|
| プロジェクトマネージャー | エグゼクティブサマリー、3.目的とゴール、13.リスクと対策、14.今後の展望、16.法規制・コンプライアンス |
| エンジニア | 8.システム構成、9.技術スタック、10.実装状況、12.開発・テスト戦略 |
| QA/テストエンジニア | 6.機能要件、11.UI/UXフロー、12.開発・テスト戦略、17.利用シナリオ |
| 法務・コンプライアンス | 16.法規制・コンプライアンス、13.リスクと対策 |

## 1. はじめに

### 1.1 ドキュメントの目的

本企画書は、API 開発・テストを効率化する Chrome 拡張機能「PostPro API Tester」の全体像を整理し、現在の実装状況および今後の発展計画を示すことを目的とします。

### 1.2 想定読者

* プロジェクトマネージャー
* フロントエンドエンジニア
* QA／テストエンジニア
* API開発者
* Chrome拡張機能開発者
* 法務・コンプライアンス担当者

---

## 2. 背景と課題

### 2.1 現状の課題

* **複数ツールの煩雑さ**
  現在、Postman、Talend API Tester、curl 等、複数ツールを併用しており、ツール切り替えによる作業効率低下が発生。

* **環境依存の問題**
  デスクトップアプリ版のみの提供が多く、ブラウザ内で完結できる選択肢が限定的。

* **チーム共有の複雑さ**
  設定ファイルのバージョン管理や共有に工数がかかり、チーム間での統一が困難。

* **テスト自動化の困難**
  API テストの自動化に専門知識が必要で、開発者の学習コストが高い。

### 2.2 解決のアプローチ

ブラウザネイティブなAPI テストプラットフォームを提供し、開発からテスト、共有まで一貫したワークフローを実現する。

---

## 3. 目的とゴール

### 3.1 プロジェクトの目的

ブラウザ内だけで完結する包括的な API テストプラットフォームを提供し、開発～テスト～共有の一連作業をシームレスにする。

### 3.2 達成目標

* **現在の状況（達成済み）**
  - 主要機能の実装完了（v3.0.0）
  - Postman互換テストAPI実装
  - 包括的な単体テスト実装（Jest）
  - 統合テスト環境構築（Puppeteer）

* **短期目標（今後3ヶ月）**
  - Chrome Web Store公開準備
  - ユーザビリティテスト実施
  - パフォーマンス最適化

* **中期目標（今後6ヶ月）**
  - プラグイン機構の実装
  - CI/CDパイプライン連携機能
  - 多言語対応（英語・日本語）

---

## 4. 想定ユーザー

### 4.1 プライマリーユーザー

1. **フロントエンド開発者**
   - API統合テスト
   - モックデータ検証

2. **バックエンド開発者**
   - API開発・デバッグ
   - エンドポイント検証

3. **QA/テストエンジニア**
   - 自動テストシナリオ作成
   - 回帰テスト実行

### 4.2 セカンダリーユーザー

4. **DevOpsエンジニア**
   - CI/CDパイプライン統合
   - 監視・アラート設定

5. **プロダクトマネージャー**
   - API仕様確認
   - 進捗管理

---

## 5. システム概要

「PostPro API Tester」は、Chrome 拡張として動作し、以下の特徴を持ちます：

* **ブラウザネイティブ**: インストール不要、どこでも利用可能
* **Postman互換**: 既存ワークフローの移行が容易
* **エコーAPI連携**: 専用テストAPI（https://reply.tukutano.jp）による検証機能
* **包括的テスト**: 単体テストから統合テストまで完備
* **モジュラー設計**: 各機能が独立し、保守性が高い

---

## 6. 機能要件

### 6.1 コア機能（実装済み）

#### リクエスト送信機能
* **HTTP メソッド**: GET, POST, PUT, DELETE, PATCH, HEAD, OPTIONS
* **認証サポート**: Basic Auth, Bearer Token, API Key, OAuth2
* **ボディタイプ**: JSON, Form Data, Raw Text, Binary Files
* **ヘッダー・パラメータ**: 動的追加・編集
* **Cookie 管理**: 自動取得・送信

#### 高度なスクリプト機能
* **Pre-request スクリプト**: リクエスト前の動的処理（JavaScript実行）
* **テストスクリプト**: 
  - Postman互換API（pm.test, pm.expect等）
  - 従来形式コマンド（status, headerEquals等）
* **変数システム**: グローバル／環境／コレクション変数
* **実行結果参照**: 前回レスポンスの値を次回リクエストへ引き継ぎ

#### データ管理機能
* **コレクション管理**: 関連リクエストのグループ化
* **シナリオ実行**: 複数リクエストを順次実行するワークフロー
* **履歴管理**: リクエスト履歴の自動保存・検索
* **インポート・エクスポート**: データの共有・バックアップ

#### テスト・検証機能
* **レスポンス検証**: ステータス、ヘッダー、ボディの自動検証
* **JSONPath サポート**: 複雑なJSON構造からのデータ抽出
* **エコーAPIテスト**: 送信内容の確認・検証

### 6.2 拡張機能（計画中）

* **プラグインシステム**: 第三者による機能拡張
* **リアルタイム共有**: チーム間でのコレクション同期
* **CI/CD統合**: Jenkins/GitHub Actions連携

---

## 7. 非機能要件

### 7.1 パフォーマンス要件

* **起動時間**: 200ms以下
* **レスポンス時間**: リクエスト実行は1秒以内
* **メモリ使用量**: 50MB以下

### 7.2 セキュリティ要件

* **スクリプト実行**: サンドボックス環境での安全な実行
* **データ保護**: ローカルストレージでの暗号化
* **権限管理**: 最小権限の原則

### 7.3 拡張性要件

* **モジュラー設計**: 機能の独立性
* **プラグイン対応**: API による機能拡張
* **多言語対応**: 国際化フレームワーク

### 7.4 信頼性要件

* **テストカバレッジ**: 80%以上
* **エラーハンドリング**: 包括的なエラー処理
* **データ整合性**: バックアップ・復旧機能

---

## 8. システム構成

### 8.1 アーキテクチャ概要


### 8.2 主要コンポーネント

| コンポーネント | ファイル | 役割 |
|-------------|----------|------|
| UI管理 | app.ts, utils.ts | ユーザーインターフェース、DOM操作 |
| リクエスト処理 | requestManager.ts | HTTP リクエスト送信・レスポンス処理 |
| テスト実行 | postmanTestAPI.ts | Postman互換テストAPI実装 |
| 変数管理 | variableManager.ts | 変数の解決・置換 |
| データ管理 | collectionManager.ts, scenarioManager.ts | コレクション・シナリオ管理 |
| 状態管理 | state.ts | グローバル状態・ローカルストレージ |
| 拡張機能基盤 | background.ts, content.ts | Chrome拡張機能フレームワーク |

---

## 9. 技術スタック

### 9.1 開発技術

* **言語・フレームワーク**
  - TypeScript 5.8.3: 型安全な開発
  - Vite 5.0.0: 高速ビルドシステム
  - Chrome Extensions API v3: マニフェストv3対応

* **ライブラリ**
  - JSONPath Plus 8.0.0: JSONパス処理
  - Jest 29.5.0: 単体テスト
  - Puppeteer 21.0.0: 統合テスト

### 9.2 ビルド・デプロイ

* **ビルドツール**: Vite + Rollup
* **型チェック**: TypeScript Compiler
* **テスト**: Jest + ts-jest
* **パッケージング**: Chrome Extension Package

### 9.3 品質管理

* **テスト戦略**
  - 単体テスト: Jest（utils, state, variableManager等）
  - 統合テスト: Puppeteer（extension-simplified.test.ts）
  - ビルドテスト: 拡張機能の動作確認

* **コード品質**
  - TypeScript厳密モード
  - ESLint（設定予定）
  - コードカバレッジ測定

---

## 10. 現在の実装状況

### 10.1 完了済み機能

#### コア機能
- ✅ HTTP リクエスト送信（全メソッド対応）
- ✅ 認証システム（Basic, Bearer, API Key, OAuth2）
- ✅ Pre-requestスクリプト実行
- ✅ Postman互換テストAPI
- ✅ 変数システム（3階層）
- ✅ コレクション・シナリオ管理
- ✅ リクエスト履歴
- ✅ インポート・エクスポート
- ✅ エコーAPIテスト

#### 開発基盤
- ✅ TypeScript設定
- ✅ Viteビルドシステム
- ✅ Jest単体テスト（5ファイル）
- ✅ Puppeteer統合テスト
- ✅ Chrome拡張機能パッケージング

#### UI/UX
- ✅ レスポンシブデザイン
- ✅ タブベースUI
- ✅ エラーハンドリング
- ✅ ローディング表示

### 10.2 現在のファイル構成


---

## 11. UI/UX フロー

### 11.1 基本ワークフロー

1. **拡張機能起動**
   - 拡張アイコンをクリック → メイン画面表示
   - 初回起動時：サンプルデータ読み込み

2. **リクエスト作成・実行**
   - 新規リクエスト作成
   - メソッド・URL・認証設定
   - ヘッダー・パラメータ・ボディ編集
   - Pre-requestスクリプト設定
   - 「Send」ボタンでリクエスト実行

3. **レスポンス確認・テスト**
   - レスポンス受信 → 構造化表示
   - テストスクリプト自動実行
   - テスト結果のアサーション表示

4. **データ管理**
   - リクエスト保存・コレクション追加
   - シナリオへの組み込み
   - 履歴からの再実行

### 11.2 高度なワークフロー

1. **シナリオ実行**
   - 複数リクエストの順次実行
   - 中間結果の変数への保存
   - エラー時の停止・継続選択

2. **チーム共有**
   - コレクションのエクスポート
   - 設定の共有・インポート
   - 環境変数の管理

---

## 12. 開発・テスト戦略

### 12.1 テスト体系

#### 単体テスト（Jest）

#### 統合テスト（Puppeteer）

### 12.2 品質保証

* **継続的テスト**: 
  - 単体テスト：`npm run test`
  - 統合テスト：Puppeteerによる自動テスト
  - ビルドテスト：拡張機能の動作確認

* **コードカバレッジ**: Jestによるカバレッジ測定
* **型安全性**: TypeScript厳密モードによる静的解析

---

## 13. リスクと対策

### 13.1 技術的リスク

| リスク | 影響度 | 対策 |
|--------|--------|------|
| Chrome API制限・変更 | 高 | 定期的なマニフェストアップデート、フォールバック実装 |
| スクリプト実行によるセキュリティ脆弱性 | 高 | サンドボックス強化、CSP制約、入力検証 |
| パフォーマンス劣化 | 中 | プロファイリング、遅延読み込み、キャッシュ最適化 |
| ブラウザ互換性 | 中 | Chrome以外のブラウザサポート検討 |

### 13.2 事業的リスク

| リスク | 影響度 | 対策 |
|--------|--------|------|
| 競合ツールとの差別化不足 | 中 | プラグイン機構、独自機能開発 |
| ユーザー獲得の困難 | 中 | Chrome Web Store最適化、コミュニティ構築 |
| 開発リソース不足 | 低 | モジュラー設計による保守性向上 |

### 13.3 運用リスク

| リスク | 影響度 | 対策 |
|--------|--------|------|
| エコーAPIの可用性 | 中 | フォールバックURL、ローカルエコー機能 |
| データ損失 | 低 | 定期バックアップ、エクスポート機能 |
| サポート対応 | 低 | ドキュメント充実、FAQ整備 |

---

## 14. 今後の展望

### 14.1 短期計画（3ヶ月）

#### Chrome Web Store公開
- ストア用アセット準備
- プライバシーポリシー・利用規約のWeb公開版準備（16章詳細参照）
- アプリケーション審査対応

#### ユーザビリティ改善
- ユーザーテスト実施
- UI/UX最適化
- パフォーマンス向上

### 14.2 中期計画（6ヶ月）

#### 機能拡張
- **プラグインシステム**: 第三者による機能拡張
- **CI/CD連携**: Jenkins/GitHub Actions連携
- **多言語対応**: i18n実装

#### エコシステム拡張
- **API拡張**: RESTful API提供
- **クラウド同期**: チーム共有機能
- **企業向け機能**: 組織管理、権限制御

### 14.3 長期計画（1年）

#### プラットフォーム拡張
- **モバイル対応**: PWA化によるタブレット・スマートフォンサポート
- **デスクトップアプリ**: Electron版の提供
- **VSCode拡張**: 開発環境統合

#### AI/ML統合
- **スマートテスト**: AI による自動テストケース生成
- **異常検知**: レスポンスパターン分析
- **最適化提案**: パフォーマンス改善提案

---

## 15. 成功指標

### 15.1 技術指標

* **コードカバレッジ**: 80%以上維持
* **ビルド時間**: 30秒以下
* **拡張機能サイズ**: 5MB以下
* **メモリ使用量**: 50MB以下

### 15.2 品質指標

* **バグ発生率**: 月1件以下
* **テスト実行時間**: 5分以下
* **ドキュメント更新**: 週1回以上

### 15.3 ユーザー指標（公開後）

* **インストール数**: 1000+（3ヶ月）
* **アクティブユーザー**: 500+（6ヶ月）
* **ユーザー評価**: 4.0以上
* **リテンション率**: 60%以上

---

## 16. 法規制・コンプライアンス

### 16.1 プライバシーポリシー

#### データ収集・利用に関する方針
* **収集するデータ**
  - リクエスト履歴（ローカル保存のみ）
  - ユーザー設定・環境変数
  - テスト結果・パフォーマンスデータ

* **データの利用目的**
  - 拡張機能の動作・設定保持
  - ユーザー体験の向上
  - テスト結果の表示・管理

* **データの保存・管理**
  - すべてのデータはローカル（Chrome Storage API）に保存
  - 外部サーバーへの自動送信は行わない
  - エコーAPI（reply.tukutano.jp）使用時のみ、テスト目的でデータ送信

#### 第三者サービス利用
* **エコーAPI（reply.tukutano.jp）**
  - テスト検証目的でのみ利用
  - 送信データはテスト実行後に破棄
  - SSL/TLS暗号化による通信

### 16.2 利用規約

#### 使用許諾・制限事項
* **使用許諾**
  - 個人・商用利用を問わず無償で利用可能
  - 改変・再配布は禁止
  - リバースエンジニアリング禁止

* **責任制限**
  - 拡張機能の利用による損害について開発者は責任を負わない
  - API送信内容の機密性確保はユーザーの責任
  - データ損失リスクについてはエクスポート機能による定期バックアップを推奨

* **禁止事項**
  - 違法・有害なAPI呼び出し
  - 第三者システムへの不正アクセス
  - 大量リクエストによるサービス妨害

### 16.3 セキュリティ・データ保護

#### セキュリティ対策
* **スクリプト実行セキュリティ**
  - Content Security Policy（CSP）による制限
  - サンドボックス実行環境
  - DOM操作制限

* **認証情報の保護**
  - ローカルストレージでの暗号化保存
  - メモリ上での平文保持時間最小化
  - 認証トークンの自動期限管理

#### データ保護方針
* **暗号化**
  - 認証情報：AES-256暗号化
  - 設定データ：Base64エンコーディング
  - 通信：HTTPS強制

* **アクセス制御**
  - Chrome拡張機能の最小権限原則
  - 必要最小限のAPIアクセス権限
  - ユーザー同意ベースの権限付与

### 16.4 Chrome Web Store 審査対応

#### 必要な法的文書
* **プライバシーポリシー**: Web公開版の準備
* **利用規約**: 詳細版の作成
* **データ取り扱い説明書**: Chrome Web Store向け

#### 審査基準適合性
* **権限使用の妥当性**: 機能に必要な最小権限のみ要求
* **ユーザーデータ保護**: ローカル保存原則の遵守
* **悪意のあるコード**: 静的解析・動的解析による検証済み

---

## 17. 利用シナリオ

### 17.1 ペルソナベース利用シナリオ

#### シナリオ1: フロントエンド開発者（田中さん）
**状況**: Reactアプリケーションで新しいAPIを統合中

**典型的な作業フロー**:
1. **API仕様確認**
   - 新規リクエスト作成
   - HTTPメソッド・エンドポイント設定
   - 必要な認証情報（API Key）設定

2. **初回テスト実行**
   - 「Send」ボタンでリクエスト送信
   - レスポンス構造の確認
   - JSONパスでの必要データ抽出確認

3. **フロントエンド統合**
   - Pre-requestスクリプトでCSRFトークン取得
   - 変数システムで環境別エンドポイント管理
   - テストスクリプトでレスポンス検証

4. **継続的検証**
   - リクエストをコレクションに保存
   - 開発中の継続的なAPI動作確認
   - 履歴機能での過去の実行結果参照

#### シナリオ2: QAエンジニア（佐藤さん）
**状況**: APIの回帰テスト自動化

**典型的な作業フロー**:
1. **テストシナリオ構築**
   - 複数のAPIエンドポイントをコレクション化
   - 依存関係のあるリクエストをシナリオとして順次実行設定
   - 各リクエストにテストスクリプト追加

2. **回帰テスト実行**
   - シナリオ一括実行
   - 各ステップの成功・失敗確認
   - エラー発生時の詳細ログ確認

3. **テスト結果管理**
   - テスト結果のエクスポート
   - 開発チームとの結果共有
   - バグ発見時の再現手順記録

#### シナリオ3: DevOpsエンジニア（山田さん）
**状況**: 本番環境のAPI監視・ヘルスチェック

**典型的な作業フロー**:
1. **監視用リクエスト作成**
   - 各マイクロサービスのヘルスチェックエンドポイント設定
   - 環境変数で本番・ステージング環境切り替え
   - レスポンス時間・ステータスコード監視

2. **定期実行設定**
   - シナリオ機能で複数サービスの一括ヘルスチェック
   - エラー閾値設定
   - 異常検知時のアラート確認

### 17.2 チーム協業シナリオ

#### シナリオ1: API仕様変更時のチーム共有
**状況**: バックエンドAPI仕様変更時の情報共有

**作業フロー**:
1. **API仕様変更の確認**（バックエンド開発者）
   - 変更されたエンドポイントのテスト実行
   - 新しいリクエスト・レスポンス形式の確認
   - コレクションの更新

2. **設定共有**（バックエンド → フロントエンド）
   - 更新されたコレクションのエクスポート
   - 変更内容の説明文書と合わせてチーム共有
   - 環境変数設定の共有

3. **統合確認**（フロントエンド開発者）
   - 共有されたコレクションのインポート
   - 既存コードとの互換性確認
   - 必要に応じたフロントエンド側の修正

#### シナリオ2: 新人エンジニアのオンボーディング
**状況**: 新メンバーのAPI理解促進

**作業フロー**:
1. **基本設定共有**
   - サンプルデータを含むコレクション提供
   - 環境変数テンプレートの共有
   - テスト用エコーAPIでの基本操作学習

2. **実践的学習**
   - 既存APIエンドポイントでの実習
   - エラーハンドリングの実践
   - テストスクリプト作成の学習

3. **独立作業への移行**
   - 担当機能のAPI実装・テスト
   - コレクションの独自拡張
   - チームへの質問・フィードバック

### 17.3 高度な利用シナリオ

#### A/Bテスト支援
* **並行バージョンテスト**: 同一APIの異なるバージョンを並行実行
* **パフォーマンス比較**: レスポンス時間・データサイズの比較
* **結果分析**: テスト結果の統計的分析

#### CI/CD パイプライン統合（将来）
* **自動テスト実行**: ビルドプロセスでのAPI回帰テスト
* **デプロイメント検証**: 本番デプロイ後の自動ヘルスチェック
* **品質ゲート**: テスト失敗時のデプロイ停止

---

## 18. まとめ

「PostPro API Tester」は、既に強固な技術基盤と包括的な機能を持つ成熟したプロダクトです。本企画書で明確にした法規制・コンプライアンス要件と詳細な利用シナリオを基に、Chrome Web Storeでの公開、ユーザーコミュニティの構築、そして次世代のAPI開発ツールへの発展を目指します。

### 18.1 プロジェクトの強み

* **完成度の高い実装**: 主要機能がすべて実装済み
* **Postman互換性**: 既存ワークフローの移行が容易
* **包括的テスト**: 単体テストから統合テストまで完備
* **モジュラー設計**: 保守性と拡張性を両立
* **エコーAPI統合**: 独自のテスト検証機能
* **法規制対応**: プライバシーポリシー・利用規約の明確化

### 18.2 改善された企画書の特徴

* **読者別ガイド**: ステークホルダーごとの最適な読書経路
* **詳細な利用シナリオ**: ペルソナベースの具体的な使用例
* **法的リスク対応**: Chrome Web Store公開に必要な法的要件の整備
* **エグゼクティブサマリー**: 意思決定者向けの要約情報

### 18.3 次のアクション

1. **Chrome Web Store公開準備**
   - プライバシーポリシー・利用規約のWeb公開
   - 審査対応文書の準備
2. **ユーザビリティテスト実施**
   - ペルソナシナリオに基づくテスト設計
3. **コミュニティ構築**
   - 利用シナリオベースのドキュメント整備
4. **プラグインシステム設計**
5. **国際化対応**

---

**PostPro API Tester** は、技術的完成度と法的コンプライアンス、そして具体的な利用価値を兼ね備えたAPI開発の未来を形作る革新的なツールとして、継続的な成長を続けていきます。